#!/usr/bin/env ruby

require 'kayakoapi-ruby'
require 'optparse'

options = {}

OptionParser.new do |opts|
  opts.banner = "Usage: kayakoapi-ruby [options]"

  opts.on("-u", "--url [URL]", "Base URL for your API Call") do |url|
    options[:url] = url || ''
  end

  opts.on("-k", "--key [KEY]", "API Key from your Kayako Helpdesk") do |key|
    options[:app_key] = key || ''
  end

  opts.on("-s", "--secret [SECRET]", "API Secret from your Kayako Helpdesk") do |secret|
    options[:secret] = secret || ''
  end

  opts.on_tail("-h", "--help", "Show this message") do
    puts opts
    exit
  end

  opts.on_tail("--version", "Show version") do
    puts "Kayako API URL Generator: v#{Kayakoapi::VERSION}"
    exit
  end
end.parse!

[:url, :app_key, :secret].each do |setting|
  if options[setting] == nil
    print  "Please enter a value for #{setting}: "
    options[setting] = gets
  end

  app = Kayakoapi::App.new(options[:url], options[:app_key], options[:secret])
  app.run
end